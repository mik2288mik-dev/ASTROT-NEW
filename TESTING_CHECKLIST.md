# –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ API `/pages/api/users/[id].ts`
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `storageService.ts`
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `App.tsx`
- [x] –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `/scripts/test-db.ts`
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `npm run test-db` –≤ package.json

## üß™ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ë–î
```bash
npm run test-db
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω
‚úÖ is_setup = true (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å onboarding)
‚úÖ –ö–∞—Ä—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
‚úÖ –ö–∞—Ä—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
‚úÖ –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª null (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

## üßë‚Äçüíª –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥)

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
   ```bash
   npm run dev
   ```

2. **–û—Ç–∫—Ä—ã—Ç—å –≤ Telegram WebApp** (–∏–ª–∏ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å)

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:**
   ```
   [App] Loading user data from database...
   [StorageService] [getProfile] Response received
   [StorageService] [getProfile] Profile not found in database (404), returning null
   [App] No user data found in database, showing onboarding form
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI:**
   - ‚úÖ –î–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **Onboarding** (—Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö)
   - ‚úÖ –ß–µ–∫–±–æ–∫—Å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –≤—Ö–æ–¥–æ–≤" –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–æ—Ç–º–µ—á–µ–Ω** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

5. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:**
   - –ò–º—è: `–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å`
   - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: `1990-01-01`
   - –í—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è: `12:00`
   - –ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è: `–ú–æ—Å–∫–≤–∞, –†–æ—Å—Å–∏—è`
   - –ß–µ–∫–±–æ–∫—Å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ": ‚úÖ **–æ—Ç–º–µ—á–µ–Ω**

6. **–ù–∞–∂–∞—Ç—å "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ö–∞—Ä—Ç—É"**

7. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```
   [Onboarding] Submitting profile:
     isSetup: true ‚úÖ
   [App] Onboarding complete, saving profile...
   [StorageService] [saveProfile] Starting save
   [StorageService] [saveProfile] Successfully saved profile to database
   [App] Profile saved successfully ‚úÖ
   [App] Calculating natal chart...
   [App] Chart generated, saving...
   [App] Chart saved successfully ‚úÖ
   ```

8. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI:**
   - ‚úÖ –î–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **Hook** (–ø–µ—Ä–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Oracle)
   - ‚úÖ –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Hook ‚Üí **Dashboard** (–∫–æ—Å–º–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥)

1. **–ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**

2. **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–æ–≤–∞**

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```
   [App] Loading user data from database...
   [StorageService] [getProfile] Response received in XXms
   [StorageService] [getProfile] Successfully loaded profile from database
     isSetup: true ‚úÖ
   [App] Loaded data from database:
     hasProfile: true ‚úÖ
     profileIsSetup: true ‚úÖ
   [App] User data found in database, preparing to show chart ‚úÖ
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI:**
   - ‚úÖ –î–æ–ª–∂–Ω–∞ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **Dashboard** (–∫–æ—Å–º–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç)
   - ‚ùå **–ù–ï –¥–æ–ª–∂–Ω–∞** –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Onboarding

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –æ—Ç–º–µ—Ç–∏–ª "–ó–∞–ø–æ–º–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"

1. **–£–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î** (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π Telegram ID)

2. **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**

3. **–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É Onboarding:**
   - –ß–µ–∫–±–æ–∫—Å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ": ‚ùå **–ù–ï –æ—Ç–º–µ—á–µ–Ω**

4. **–ù–∞–∂–∞—Ç—å "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ö–∞—Ä—Ç—É"**

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   ```
   [Onboarding] Submitting profile:
     isSetup: false ‚úÖ
   [App] User chose not to save data, skipping profile save
   [App] User chose not to save data, skipping chart save
   ```

6. **–ó–∞–∫—Ä—ã—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–æ–≤–∞**

7. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å UI:**
   - ‚úÖ –î–æ–ª–∂–Ω–∞ —Å–Ω–æ–≤–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ **Onboarding** (–¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å)

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Production

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –í—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã (`npm run test-db`)
- [ ] –í—Å–µ —Ä—É—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- [ ] –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- [ ] `DATABASE_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Railway Variables

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Health endpoint:**
   ```bash
   curl https://your-app.railway.app/api/health
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Railway:**
   - –ò—Å–∫–∞—Ç—å `[StorageService]` –ª–æ–≥–∏
   - –ò—Å–∫–∞—Ç—å `[App] Loaded data from database` –ª–æ–≥–∏
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `isSetup` –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `true` –∏–ª–∏ `false`, –∞ –Ω–µ `undefined`

3. **–¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –ü–æ–ø—Ä–æ—Å–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–π—Ç–∏ Onboarding
   - –ü–æ–ø—Ä–æ—Å–∏—Ç—å –∑–∞–∫—Ä—ã—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–æ–≤–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Dashboard

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Profile not found (404)" –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –±—ã–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ë–î (–≤–æ–∑–º–æ–∂–Ω–æ, —Å–Ω—è—Ç —á–µ–∫–±–æ–∫—Å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ")

**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: `[App] Profile saved successfully`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `isSetup: true` –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: Onboarding –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü—Ä–∏—á–∏–Ω–∞:** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `is_setup` –≤–º–µ—Å—Ç–æ `isSetup`

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ `/pages/api/users/[id].ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `profileIsSetup: true` (–Ω–µ `undefined`)

### –ü—Ä–æ–±–ª–µ–º–∞: "DATABASE_URL is not configured"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ - —Å–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª:
DATABASE_URL=postgresql://user:password@host:port/database

# –í Railway - –¥–æ–±–∞–≤–∏—Ç—å –≤ Variables:
DATABASE_URL = [–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω Railway]
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ 0% —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–∏–¥—è—Ç Onboarding –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ
- ‚úÖ 100% –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–∏–¥—è—Ç Onboarding –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
- ‚úÖ 100% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Ç–º–µ—Ç–∏–≤—à–∏—Ö "–ó–∞–ø–æ–º–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ", –≤–∏–¥—è—Ç Dashboard –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ
- ‚úÖ 0% –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏/–∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –ë–î
npm run test-db

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
npm run migrate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä —Å –ª–æ–≥–∞–º–∏
npm run dev

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä
npm run lint
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞

–í –±—Ä–∞—É–∑–µ—Ä–µ (DevTools Console):
- `[StorageService]` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
- `[App] Loaded data from database` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- `[Onboarding] Submitting profile` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- `isSetup:` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–ª–∞–≥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

–í Railway (Logs):
- `[API/users/[id]] [GET] User found` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `[API/users/[id]] [POST] User saved` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `[DB]` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
