# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–π

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. Railway –∞–∫–∫–∞—É–Ω—Ç —Å —Å–æ–∑–¥–∞–Ω–Ω–æ–π PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
2. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `DATABASE_URL` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DATABASE_URL

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ `DATABASE_URL`:

1. **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π URL** (`postgres.railway.internal`) - –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ Railway
2. **–ü—É–±–ª–∏—á–Ω—ã–π URL** (`containers-us-west-xxx.railway.app`) - –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ

**–î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL!**

### üìù –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ DATABASE_URL

**–®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Railway Dashboard**
- –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://railway.app
- –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
- –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç

**–®–∞–≥ 2: –ù–∞–π–¥–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**
- –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Database"** –∏–ª–∏ **"Postgres"**
- –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

**–®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL**
- –í –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è –æ–∫–Ω–µ –Ω–∞–π–¥–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É **"Connect"** –∏–ª–∏ **"Connection"**
- –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Public Networking"** –∏–ª–∏ **"Public URL"**
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `postgresql://`)
- –≠—Ç–æ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π DATABASE_URL

**–®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞**
- –í Railway Dashboard –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à **–ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** (–Ω–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö)
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"Variables"** –∏–ª–∏ **"Environment Variables"**
- –ù–∞–π–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DATABASE_URL` –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é
- –í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π URL
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç**
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```
postgresql://postgres:–ø–∞—Ä–æ–ª—å@containers-us-west-123.railway.app:5432/railway
```
- ‚úÖ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `postgresql://`
- ‚úÖ –•–æ—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç `containers-` (–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ–º–µ–Ω)
- ‚úÖ –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç `railway.internal`

üìö **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º. —Ñ–∞–π–ª `RAILWAY_DATABASE_SETUP.md`

### –§–æ—Ä–º–∞—Ç DATABASE_URL

```
postgresql://user:password@host:port/database
```

–ü—Ä–∏–º–µ—Ä:
```
postgresql://postgres:password123@containers-us-west-123.railway.app:5432/railway
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ DATABASE_URL

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:

```bash
# –í Railway Dashboard ‚Üí Variables –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
# 1. DATABASE_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
# 2. –•–æ—Å—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç "railway.internal" (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å–µ—Ç—å)
# 3. –§–æ—Ä–º–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç postgresql://user:password@host:port/database
```

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ú–∏–≥—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:

### –¢–∞–±–ª–∏—Ü–∞ `migrations`
–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- `id` (SERIAL PRIMARY KEY)
- `name` (VARCHAR UNIQUE) - –∏–º—è –º–∏–≥—Ä–∞—Ü–∏–∏
- `applied_at` (TIMESTAMP) - –≤—Ä–µ–º—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

### –¢–∞–±–ª–∏—Ü–∞ `users`
–ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `id` (VARCHAR PRIMARY KEY) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `name` (VARCHAR) - –∏–º—è
- `birth_date` (VARCHAR) - –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
- `birth_time` (VARCHAR) - –≤—Ä–µ–º—è —Ä–æ–∂–¥–µ–Ω–∏—è
- `birth_place` (VARCHAR) - –º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è
- `is_setup` (BOOLEAN) - –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- `language` (VARCHAR) - —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- `theme` (VARCHAR) - —Ç–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- `is_premium` (BOOLEAN) - –ø—Ä–µ–º–∏—É–º —Å—Ç–∞—Ç—É—Å
- `is_admin` (BOOLEAN) - –∞–¥–º–∏–Ω —Å—Ç–∞—Ç—É—Å
- `three_keys` (JSONB) - —Ç—Ä–∏ –∫–ª—é—á–∞
- `evolution` (JSONB) - —ç–≤–æ–ª—é—Ü–∏—è
- `premium_activated_at` (TIMESTAMP) - –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–µ–º–∏—É–º–∞
- `premium_stars_amount` (INTEGER) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥
- `premium_transaction_id` (VARCHAR) - ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `created_at` (TIMESTAMP) - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` (TIMESTAMP) - –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –¢–∞–±–ª–∏—Ü–∞ `charts`
–ù–∞—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `user_id` (VARCHAR PRIMARY KEY) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (FOREIGN KEY)
- `chart_data` (JSONB) - –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã
- `created_at` (TIMESTAMP) - –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` (TIMESTAMP) - –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–ú–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:

1. **–ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏** (`postbuild` —Å–∫—Ä–∏–ø—Ç –≤ `package.json`)
2. **–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ** –∫ `/api/health` (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç)
3. **–í—Ä—É—á–Ω—É—é** —á–µ—Ä–µ–∑ `/api/migrations/run`

### –ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–π

1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π `DATABASE_URL`
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å retry –ª–æ–≥–∏–∫–æ–π (3 –ø–æ–ø—ã—Ç–∫–∏)
3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `migrations` (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ø–æ –ø–æ—Ä—è–¥–∫—É:
   - `001_create_users_table` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã users
   - `002_create_charts_table` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã charts
   - `003_create_indexes` - —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
5. –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ
6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API

```bash
# –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
curl https://your-app.railway.app/api/migrations/run

# –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
# {
#   "success": true,
#   "message": "Migrations completed successfully",
#   "tables": {
#     "existedBefore": false,
#     "existAfter": true,
#     "allRequiredTablesExist": true,
#     "tableStatus": [
#       { "table": "migrations", "exists": true },
#       { "table": "users", "exists": true },
#       { "table": "charts", "exists": true }
#     ]
#   }
# }
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Railway Database Query

–í Railway Dashboard ‚Üí Database ‚Üí Query –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public'
ORDER BY table_name;

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–∞–±–ª–∏—Ü—ã: charts, migrations, users

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π
SELECT * FROM migrations ORDER BY applied_at DESC;

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏:
-- 001_create_users_table
-- 002_create_charts_table
-- 003_create_indexes

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã users
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'users'
ORDER BY ordinal_position;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã charts
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'charts'
ORDER BY ordinal_position;
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏ Railway

–í Railway Dashboard ‚Üí Deployments ‚Üí Logs –∏—â–∏—Ç–µ:

```
[Migrations] Starting database migrations...
[Migrations] Database connection established
[Migrations] Migrations table created/verified
[Migrations] Applying migration 001_create_users_table...
[Migrations] Migration 001_create_users_table applied successfully
[Migrations] Applying migration 002_create_charts_table...
[Migrations] Migration 002_create_charts_table applied successfully
[Migrations] Applying migration 003_create_indexes...
[Migrations] Migration 003_create_indexes applied successfully
[Migrations] Verifying tables were created...
[Migrations] ‚úì Table migrations exists
[Migrations] ‚úì Table users exists
[Migrations] ‚úì Table charts exists
[Migrations] All required tables verified successfully
[Migrations] All migrations completed successfully
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
- –¢–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –û—à–∏–±–∫–∞ "DATABASE_URL is not configured"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `DATABASE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Railway Variables
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–π URL (–Ω–µ `railway.internal`)
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é: `curl https://your-app.railway.app/api/migrations/run`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–°–∏–º–ø—Ç–æ–º—ã:**
- `getaddrinfo ENOTFOUND postgres.railway.internal`
- `Error: connect ECONNREFUSED`
- `Connection timeout`

**–†–µ—à–µ–Ω–∏–µ:**
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π DATABASE_URL** –≤–º–µ—Å—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—â–µ–Ω–∞ –≤ Railway
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç `DATABASE_URL` (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `postgresql://`)
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SSL –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–¥–ª—è production)

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ, –Ω–æ —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç
- –û—à–∏–±–∫–∞ "Required tables are missing"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `migrations`: `SELECT * FROM migrations;`
2. –ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ, –Ω–æ —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç:
   ```sql
   -- –£–¥–∞–ª–∏—Ç–µ –∑–∞–ø–∏—Å–∏ –æ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
   DELETE FROM migrations WHERE name IN (
     '001_create_users_table',
     '002_create_charts_table',
     '003_create_indexes'
   );
   ```
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ API –∏–ª–∏ Railway CLI
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü

### –ü—Ä–æ–±–ª–µ–º–∞: Foreign key constraint fails

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã `charts`
- "foreign key constraint" –æ—à–∏–±–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `users` —Å–æ–∑–¥–∞–Ω–∞ –ø–µ—Ä–µ–¥ `charts`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: 001, 002, 003)
3. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, —Å–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL

## üìù –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π

### –ß–µ—Ä–µ–∑ Railway CLI

```bash
railway run npm run migrate
```

### –ß–µ—Ä–µ–∑ API endpoint

```bash
# GET –∑–∞–ø—Ä–æ—Å
curl https://your-app.railway.app/api/migrations/run

# POST –∑–∞–ø—Ä–æ—Å
curl -X POST https://your-app.railway.app/api/migrations/run
```

### –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ DATABASE_URL –≤ .env —Ñ–∞–π–ª
echo "DATABASE_URL=your-public-database-url" > .env

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
npm run migrate
```

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ß–µ—Ä–µ–∑ Railway CLI
railway run psql $DATABASE_URL

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ psql (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
psql $DATABASE_URL
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –í Railway Dashboard ‚Üí Variables –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
# - DATABASE_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
# - NODE_ENV=production (–¥–ª—è production)
```

### –õ–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–π

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[Migrations]`. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –º–∏–≥—Ä–∞—Ü–∏–π.

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] –°–æ–∑–¥–∞–Ω–∞ PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Railway
- [ ] –ü–æ–ª—É—á–µ–Ω –ø—É–±–ª–∏—á–Ω—ã–π `DATABASE_URL` (–Ω–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
- [ ] `DATABASE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Railway Variables
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–ø—É—â–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é
- [ ] –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã (`migrations`, `users`, `charts`)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ SQL –∑–∞–ø—Ä–æ—Å—ã
- [ ] API endpoint `/api/migrations/run` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –°–º. `DEPLOYMENT.md` –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–µ–ø–ª–æ–µ
- –°–º. `README.md` –¥–ª—è –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ
- –°–º. `lib/migrations.ts` –¥–ª—è –∫–æ–¥–∞ –º–∏–≥—Ä–∞—Ü–∏–π